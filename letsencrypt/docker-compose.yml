version: '3.7'

services: 
  nginx-proxy: 
    restart: always
    image: jwilder/nginx-proxy:${NGINX_PROXY_VERSION}
    container_name: nginx-proxy
    ports: 
      - '80:80'
      - '443:443'
    volumes: 
      - './nginx/vhost.d:/etc/nginx/vhost.d'
      - './nginx/html:/usr/share/nginx/html'
      - './nginx/certs:/etc/nginx/certs:ro'
    networks: 
      - letsencrypt-network
    labels: 
      - 'com.github.jrcs.letsencrypt_nginx_proxy_companion.nginx_proxy'


  letsencrypt-proxy:
    restart: always
    image: jrcs/letsencrypt-nginx-proxy-companion:${LETSENCRYPT_PROXY_VERSION}
    container_name: letsencrypt-proxy
    depends_on: 
      - nginx-proxy
    volumes: 
      - './nginx/certs:/etc/nginx/certs:rw'
      - '/var/run/docker.sock:/var/run/docker.sock:ro'
    networks: 
      - letsencrypt-network
  
    
networks: 
  letsencrypt-network:
    driver: bridge